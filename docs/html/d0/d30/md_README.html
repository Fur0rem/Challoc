<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>challoc: Challoc</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">challoc<span id="projectnumber">&#160;1.0.0</span>
   </div>
   <div id="projectbrief">Master 1 CHPS : AISE 2025 project</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Challoc</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md0"></a> Challoc est un projet d'allocateur mémoire simple en C pour l'UE AISE du master CHPS de Paris-Saclay. Il contient les fonctions suivantes avec la même signature que celles de la libc : </p><div class="fragment"><div class="line"><span class="keywordtype">void</span>* challoc(<span class="keywordtype">size_t</span> size);</div>
<div class="line"><span class="keywordtype">void</span> chafree(<span class="keywordtype">void</span>* ptr);</div>
<div class="line"><span class="keywordtype">void</span>* charealloc(<span class="keywordtype">void</span>* ptr, <span class="keywordtype">size_t</span> size);</div>
<div class="line"><span class="keywordtype">void</span>* chacalloc(<span class="keywordtype">size_t</span> nmemb, <span class="keywordtype">size_t</span> size);</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1"></a>
Architecture du code</h1>
<p>Le code est structuré de la manière suivante :</p><ul>
<li><code>src/</code> contient les fichiers sources de l'allocateur mémoire.</li>
<li><code>docs/</code> contient la documentation du code.</li>
<li><code>tests/</code> pour les tests, vérifiant le bon fonctionnement de l'allocateur, de la détection de fuites mémoires, et de l'interposition des fonctions de la libc.</li>
<li><code>benchmarks/</code> pour les fichiers des benchmarks, des programmes C à utiliser pour comparer la performance par rapport à d'autres allocateurs, ainsi que leur résultats.</li>
<li><code>rapport/</code> contient les fichiers du rapport.</li>
<li><code>target/</code> contient les fichiers compilés.</li>
<li><code>Makefile</code> pour compiler le projet.</li>
<li><code>.clang-format et .clang-tidy</code> pour formatter et analyser le code.</li>
<li><code>Doxyfile</code> pour générer la documentation.</li>
<li><code>default.nix</code> pour les utilisateurs du gestionnaire de paquets Nix.</li>
</ul>
<h1><a class="anchor" id="autotoc_md2"></a>
Compilation</h1>
<p>Tout est dans le Makefile : </p><div class="fragment"><div class="line">libchalloc.so</div>
</div><!-- fragment --><p> pour compiler la bibliothèque partagée avec interposition des fonctions de la libc </p><div class="fragment"><div class="line">libchalloc_dev.so</div>
</div><!-- fragment --><p> pour compiler la bibliothèque partagée sans interposition et avec des assertions en plus. </p><div class="fragment"><div class="line">check</div>
</div><!-- fragment --><p> pour lancer les tests. </p><div class="fragment"><div class="line">benchmarks LABEL=&lt;label&gt;</div>
</div><!-- fragment --><p> pour lancer les benchmarks temps et mémoire qui seront stockés dans le dossier <code>benchmarks/label/</code> avec le label spécifié puis mis en image dans le dossier <code>rapport/bench_results/label/</code>. </p><div class="fragment"><div class="line">doc</div>
</div><!-- fragment --><p> pour générer la documentation. </p><div class="fragment"><div class="line">rapport</div>
</div><!-- fragment --><p> pour générer le rapport fait en Typst. </p><div class="fragment"><div class="line">clean</div>
</div><!-- fragment --><p> pour nettoyer les fichiers compilés.</p>
<p>Lors de la compilation, la variable LEAKCHECK peut être définie (à 1, true, ou t) pour activer la vérification de fuites mémoires, ex : <code>make libchalloc.so LEAKCHECK=true</code>.</p>
<p>D'ailleurs, je vous invite à lire le rapport pour plus des informations sur le projet. </p>
<h1><a class="anchor" id="autotoc_md3"></a>
Utilisation</h1>
<p>Voici comment utiliser Challoc dans votre projet :</p>
<ol type="1">
<li>Incluez le fichier d'en-tête <code>&lt;stdlib.h&gt;</code> dans votre fichier source, ou le fichier d'en-tête <code>challoc.h</code> si souhaitez utiliser challoc sans interposition.</li>
<li>Compilez votre programme avec la bibliothèque partagée <code>libchalloc.so</code> ou <code>libchalloc_dev.so</code> (selon si vous souhaitez interposer les fonctions de la libc ou non).</li>
<li>Lancez votre programme avec LD_PRELOAD pour charger la bibliothèque partagée. <div class="fragment"><div class="line">make libchalloc.so</div>
<div class="line">LD_PRELOAD=./libchalloc.so ./votre_programme</div>
</div><!-- fragment --></li>
</ol>
<h1><a class="anchor" id="autotoc_md4"></a>
Implémentation</h1>
<p>L'allocateur se base sur mmap. Il utilise un vecteur de blocs alloués via mmap, et chaque bloc est utilisé en sous-allouant des blocs plus petits via une double liste chaînée en algorithmes first-fit. Les blocs mmap complètement libérés sont stockés temporairement dans un vecteur de blocs libres afin de les réutiliser si possible. L'allocateur possède aussi un petit allocateur en slab pour les petites allocations de 512 octets ou moins, la slab fait une taille totale de 4Mo (1 page), séparée en 1 cache de 512 octets, 2 caches de 256 octets, 4 caches de 128 octets, ect...</p>
<h1><a class="anchor" id="autotoc_md5"></a>
Features</h1>
<ul>
<li>Support en multithreading</li>
<li>Détection de fuites mémoires</li>
<li>Interposition des fonctions de la libc </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
